#LCB Specification ver0.1 (JP)
**LCB仕様書 ver0.1**

---

## 1. 文書概要

**タイトル:** Layered Coordinate Bitstream（LCB）仕様書 ver0.1
**目的:**
LCBは、AI汎用化のための共通データレイヤーとして、各種センサーや入力データを統一形式で表現・圧縮・送信可能にすることを目的とする。
用途は、監視・医療・自動運転・言語解析・測定・分析・環境モニタリングなど多岐にわたる。

---

## 2. 基本構造

**LCB データ処理フロー:**

```
[入力デバイス/センサー] → [座標化] → [レイヤー化] → [ビット化] → [時系列ベクトル] → [軽量推論]
```

### 2.1 ヘッダ・フッタ構造

| フィールド       | ビット幅   | 説明                                 |
| ----------- | ------ | ---------------------------------- |
| Version     | 4bit   | LCB仕様バージョン                         |
| Type        | 4bit   | データ種別（0=text,1=audio,2=utt,3=ctrl） |
| Timestamp   | 64bit  | ns単位                               |
| Source ID   | 16bit  | デバイス/話者ID等                         |
| Seq         | 32bit  | 連番                                 |
| Layer Mask  | 16bit  | 送信レイヤー選択                           |
| Prev Hash   | 128bit | 前パケットハッシュ                          |
| Packet Hash | 128bit | 現パケットハッシュ                          |
| Signature   | 可変     | ECDSA署名など                          |

---

## 3. 汎用レイヤー定義

| レイヤー | 内容                         | 基本ビット幅     | 拡張フィールド     | 備考             |
| ---- | -------------------------- | ---------- | ----------- | -------------- |
| L0   | 空間座標 (x, y, z)             | 12×3=36bit | 精度拡張可能      | 1cm単位, 座標系選択可能 |
| L1   | 属性 (色・温度・音量等)              | 4×4=16bit  | 新センサー追加用可変  | 正規化 0–1        |
| L2   | 変化ベクトル (Δx, Δy, Δz, Δattr) | 5×4=20bit  | 高精度速度・加速度計測 | 時系列勾配表現        |
| L3   | 種別                         | 6bit       | カスタムタグ追加可能  | 人/車/植物/建物 等    |
| L4   | 信頼度                        | 3bit       | 拡張信頼度指標可    | 0–7            |
| L8   | メタデータ                      | 可変         | ハッシュ化や環境情報  | 発話環境、デバイス情報    |

※ 各レイヤーは拡張可能で、Layer Mask により必要レイヤーのみ送信可能。

---

## 4. 言語データ用 LCB-Lang v0.1

### 4.1 レイヤー構造（言語用）

| レイヤー | 内容                 | 基本ビット幅 | 拡張フィールド           | 備考                 |
| ---- | ------------------ | ------ | ----------------- | ------------------ |
| L0   | 時間座標（フレーム開始・継続時間）  | 64bit  | 精度拡張              | ns単位               |
| L1   | 音響属性（音量・ピッチ・周波数帯域） | 16bit  | 詳細周波数分解能          | 正規化0–1             |
| L3   | 文字・単語・音素           | 可変     | 拡張文字コード/音素        | UTF-8マッピング, 辞書ID併用 |
| L7   | 感情スコア              | 8bit   | 複合感情指標            | 喜怒哀楽など0–255        |
| L8   | メタデータ              | 可変     | 話者ID, 環境, セッション情報 | ハッシュ化推奨            |

### 4.2 文章・単語単位保持情報

| レベル  | 内容                       | 使用例                    |
| ---- | ------------------------ | ---------------------- |
| 文書単位 | 文ID, 文開始時間, 文終了時間, 文脈タグ  | 複数文をまとめた分析や推論          |
| 文章単位 | 文中のフレーズ座標, 文章スコア, 文法タグ   | 感情スコア累積, 文体判定          |
| 単語単位 | 単語ID, 辞書ID, 音素列, 発音タイミング | 辞書照合, 単語レベル感情スコア, 音声合成 |

> **補足:** 辞書は別資料で定義し、単語IDと辞書IDの対応を明確化することで、モデル容量を軽量化可能。

---

## 5. ドメイン別テンプレート例

| ドメイン  | 必須レイヤー     | 推奨レイヤー | 備考                |
| ----- | ---------- | ------ | ----------------- |
| 自動運転  | L0, L2, L3 | L1, L4 | 車・歩行者座標、速度・種別、信頼度 |
| 医療・監視 | L0, L1, L4 | L3, L8 | 人体座標、属性、信頼度、メタデータ |
| 測定・分析 | L0, L1, L2 | L3     | 建物劣化、植物成長、進行ベクトル  |
| 言語解析  | L0, L1, L3 | L7, L8 | 音声/文字/感情/メタデータ    |

---

## 6. 拡張フィールドの利用例

* 単語IDの拡張: 16bit→32bitに拡張可能
* 感情指標の細分化: 8bit→16bit
* メタデータ: セッション情報、環境センサー情報の追加
* Layer Mask により必要フィールドのみ送信、転送データ軽量化

---

## 7. 圧縮・改ざん防止

* zlib 圧縮
* ハッシュ連鎖（Prev Hash / Packet Hash）
* ECDSA署名によるパケット検証
* 匿名化ハッシュ（話者ID, デバイスID）

---

## 8. 実装資料と分離方針

* **この仕様書:** データ構造・ビット割り当て・レイヤー定義
* **別資料:**

  * 辞書作成手順
  * 単語ID/辞書ID割り当て
  * 言語・音声の前処理手順
  * デモアプリケーションコード例

> 仕様書はGitHubに公開、辞書作成や実装手順は別資料として管理することで、仕様の標準化と実装自由度を両立可能。

---
